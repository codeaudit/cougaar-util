<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.77 [en] (WinNT; U) [Netscape]">
   <meta name="Template" content="C:\Program Files\Microsoft Office\Office\html.dot">
   <title>Release Notes</title>
</head>
<body link="#0000FF" vlink="#800080">
&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="600" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td ALIGN=CENTER WIDTH="200"><a href="HTTPS://www.alpine.bbn.com/"><img SRC="alpine-logo-small.gif" BORDER=0 height=83 width=95></a></td>

<td ALIGN=CENTER WIDTH="200">
<h2>
<b><font size=+2>COUGAAR 8.6.0</font></b></h2>
</td>

<td ALIGN=CENTER WIDTH="200"><a href="http://www.cougaar.org"><img SRC="cougaar-smalllogo.jpg" BORDER=0 ></a></td>
</tr>
</table>

<table ALIGN=LEFT BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="600" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td ALIGN=LEFT WIDTH="600">
<hr>
<h1>
Heterogeneous Database Capability</h1>

<li>
Jump down to:&nbsp;</li>

<ul>
<li>
<a href="#overview">Overview</a>&nbsp;</li>

<li>
<a href="#Changes Summary">Changes Summary&nbsp;</a></li>

<li>
<a href="#Modified Source">Modified Source Files</a>&nbsp;</li>

<li>
<a href="#Data">Data Files&nbsp;</a></li>

<li>
<a href="#Changes to the format of Cougaar.rc">Changes to the format of
Cougaar.rc file&nbsp;</a></li>

<li>
<a href="#Changes to the format of the .q">Changes to the format of the
.q files&nbsp;</a></li>

<li>
<a href="#MySQL and PostgreSQL">MySQL and PostgreSQL Requirements</a>&nbsp;</li>

<li>
<a href="#MySQL">MySQL&nbsp;</a></li>

<li>
<a href="#PostgreSQL">PostgreSQL&nbsp;</a></li>

<li>
<a href="#Modified Postgresql JDBC">Modified Postgresql JDBC Driver</a></li>

<li>
<a href="#Running the">Running the Society</a></li>

<li>
<a href="#Running the">Database Table List</a></li>

<br>&nbsp;
<p>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;</ul>

<hr>
<h2>
<a NAME="overview"></a>Overview</h2>
The Oracle driver dependencies have been removed from a group of SQL query
based LDMPlugins that are used to retrieve data from an Oracle database.&nbsp;
The LDMPlugins now support connecting to any database via a JDBC database
driver.&nbsp; All data needed to support running of the SMALL-135 configuration
have been ported to both MySQL and PostgreSQL.&nbsp; These database exports
are available on the COUGAAR web site.&nbsp; Below is a highlight of the
changes and capabilities in the 8.6.0 Cougaar Release.
<ul>
<li>
18 Oracle tables were ported to MySQL and PostgreSQL</li>

<li>
The format of the cougaar.rc file was changed to support dynamic loading
of database drivers and the database URL</li>

<li>
Query files ( “.q” ) can contain a mix of queries, e.g., a default query
(works with any database) and a database specific query, e.g., query.mysql</li>

<li>
LDMPlugins were modified to load the database drivers and the database
URL as defined in the cougaar.rc file</li>

<li>
The LDMPlugins use the database type as defined in the cougaar.rc file
to determine which query to execute from the file.&nbsp; If no database
specific query is defined in the .q file the default query will be executed.</li>
</ul>

<h2>
<a NAME="Changes Summary"></a>Changes Summary&nbsp;</h2>

<h3>
<a NAME="Modified Source"></a>Modified Source Files:</h3>

<ul>
<li>
LDMQueryPlugIn.java</li>

<li>
LDMSQLPlugIn.java</li>

<li>
QueryLDMPlugIn.java – not tested</li>

<li>
UniversalExpanderPlugIn.java</li>

<li>
ConstructionGenerateDemandProjector.java</li>
</ul>

<h3>
<a NAME="Data"></a>Data Files</h3>

<ul>
<li>
Cougaar.rc – contains database names, drivers for each type of database,
user names and passwords for databases used</li>

<li>
All .q files in configs/common currently contain Oracle, MySQL and PostgreSQL
compatible queries</li>
</ul>

<h3>
<a NAME="Changes to the format of Cougaar.rc"></a>Changes to the format
of Cougaar.rc file</h3>
The drivers for each type of database are specified as follows:
<br>driver.mysql=org.gjt.mm.mysql.Driver&nbsp;
<br>driver.oracle=oracle.jdbc.driver.OracleDriver
<br>driver.postgresql=org.postgresql.Driver
<p>If the user would like to change the driver being used he/she would
adjust the cougaar.rc file accordingly.&nbsp; Secondly, any database that
is to be used within a society is named in the cougaar.rc file with the
values of the username and password specified for connecting to the database
in the following manner:
<br>org.cougaar.database=jdbc:mysql://localhost/database01
<br>org.cougaar.database.user= ULuser
<br>org.cougaar.database.password= ULpassword
<p>Multiple databases may be defined in the cougaar.rc file.&nbsp; It should
be noted that the format for the database parameter has changed.&nbsp;
“jdbc:mysql://” must be included in the database name.&nbsp; It is important
to use the new format because the modified java files derive the database
type from the database parameter: “jdbc:mysql://localhost/database01.”&nbsp;
The database type value is used in determining which driver to load and
which query to execute.&nbsp;
<p>Please see <a href="DataAccess.html">DataAccess.html</a> for the current
list of parameters needed to run a small-135 society.
<h3>
<a NAME="Changes to the format of the .q"></a>Changes to the format of
the .q files</h3>
The .q files are used to hold queries for a given database.&nbsp; References
to the database, username, and password are contained in the .q file in
the following manner:
<br>Database = ${org.cougaar.database}
<br>Username = ${org.cougaar.database.user}
<br>Password = ${org.cougaar.database.password}
<p>The values for these parameters will be substituted with the values
defined in the cougaar.rc file during execution.&nbsp; See org.cougar.util.DBProperties.java&nbsp;
and org.cougaar.util.Parameters&nbsp; for details on parameter substitution
and mapping.
<br>Because database query languages can differ in syntax, the query file
can be formatted to house multiple query types.&nbsp; You can define a
default query&nbsp; “query = select …”, intended to work with any database.&nbsp;
If the query syntax is unique to a particular database, you must define
the query as “query.dbtype = select.”&nbsp; Please note that the dbtype
value must match the database type reference defined in the database URL,&nbsp;
“jdbc:mysql://localhost/database01.”&nbsp;&nbsp; The database-specific
query, if one exists, will be executed over the default query.&nbsp; Query
examples shown below.
<p><font face="Courier New,Courier"><font size=-1>Queries that are compatible
with most databases being used are specified in the following format:</font></font>
<p><font face="Courier New,Courier"><font size=-1>query = select CAPABILITY
AS MOS_LEVEL, PERSONNEL AS MOS_QTY, 'Dummy Nomenclature' AS “Dummy Nomenclature”\</font></font>
<br><font face="Courier New,Courier"><font size=-1>&nbsp;from ORG_MOS \</font></font>
<br><font face="Courier New,Courier"><font size=-1>&nbsp;where UIC = :uic</font></font>
<p><font face="Courier New,Courier"><font size=-1>The above format indicates
that it is the default query and should work with any type of database.</font></font>
<p><font face="Courier New,Courier"><font size=-1>If the query syntax differs
depending on database type the following format is used for specifying
which query to use for each particular database type.</font></font>
<p><font face="Courier New,Courier"><font size=-1>query = select NSN, SUM(QTY_OH),
NOMENCLATURE from jtav_equipment \</font></font>
<br><font face="Courier New,Courier"><font size=-1>where&nbsp; UIC4 = substr(:uic,
1, 4) and \</font></font>
<br><font face="Courier New,Courier"><font size=-1>&nbsp; NSN in (:pacing)
\</font></font>
<br><font face="Courier New,Courier"><font size=-1>&nbsp; group by NSN,
NOMENCLATURE</font></font>
<p><font face="Courier New,Courier"><font size=-1>query.mysql = select
NSN, SUM(QTY_OH), NOMENCLATURE from jtav_equipment \</font></font>
<br><font face="Courier New,Courier"><font size=-1>where&nbsp; UIC4 = substring(:uic,
1, 4) and \</font></font>
<br><font face="Courier New,Courier"><font size=-1>&nbsp; NSN in (:pacing)
\</font></font>
<br><font face="Courier New,Courier"><font size=-1>&nbsp; group by NSN,
NOMENCLATURE</font></font>
<p><font face="Courier New,Courier"><font size=-1>Note: If a query does
not follow the above pattern (i.e. it is not named “query”), the pattern
for specifying different types would remains the same.&nbsp; An example
follows:</font></font>
<br><font face="Courier New,Courier"><font size=-1>Class1ConsumedList =
select nsn from class1_item</font></font>
<br><font face="Courier New,Courier"><font size=-1>Class1ConsumedList.mysql
= select nsn from class1_item</font></font>
<br>&nbsp;
<h2>
<a NAME="MySQL and PostgreSQL"></a>MySQL and PostgreSQL Requirements</h2>
You need access to a running MySQL or PostgreSQL database server.
<h3>
<a NAME="MySQL"></a>MySQL</h3>

<ul>
<li>
If needed, download and install the latest version of&nbsp; MySQL from
<a href="http://www.mysql.com">http://www.mysql.com</a>&nbsp;</li>

<li>
You will find a MySQL JDBC driver, version 2.0.3 ( mm-mysql-2.jar) in the
sys directory in the cougaar-support.zip.&nbsp; This one has been tested
with the 8.6.0 release.&nbsp; You can find the latest drivers at 
<a href="http://sourceforge.net/projects/mmmysql">http://sourceforge.net/projects/mmmysql</a>&nbsp;</li>

<li>
Download and import the mysqldump.8.6.txt found in the dbms/data/mysql
directory in the cougaar.zip</li>

<li>
To load: mysql -u {USER} –p{PASSWORD} {DATABASE} &lt; mysqldump.8.6.txt</li>

<li>
Or simply download the Cougaar 8.6.0 installer from the Cougaar web site
www.cougaar.org. The installer installs the MySQL server and populates
the database.</li>
</ul>

<h3>
<a NAME="PostgreSQL"></a>PostgreSQL</h3>

<h4>
<a NAME="Modified Postgresql JDBC"></a>Modified Postgresql JDBC Driver</h4>
You must use the modified PostgreSQL driver provided in the sys directory
of the cougaar-support.zip package (bbn-postgresql7.1.3.jar).&nbsp; We
found that the postgresql7.1.3 JDBC driver throws an “unknown object type”
exception while running the SMALL-135 society.&nbsp;&nbsp; This occurs
due to the driver's handling of string constants and labels in the query
statements.&nbsp; For example, the query “ select '8115001682275' AS NSN
from ue_summary_mtmc” will cause a runtime exception on the string constant
'8115001682275'.&nbsp; This syntax will work in PSQL and is only a problem
with the PostgreSQL JDBC drivers we tried.&nbsp;
<p>To get around this problem, we added the case java.sql.Types.OTHER to
the getObject() method in the org.postgresql.jdbc2.ResultSet.java file.
The source for this driver came from src/interfaces in version 7.1.3 of
the PostgreSQL database server.&nbsp; <a href="http://www.postgresql.org">http://www.postgresql.org</a>
<br>3.2.2 PostgreSQL and Time Zones
<p>The PostgreSQL server will, by default, serve time as local time.&nbsp;
The Cougaar SMALL-135 society configuration runs in GMT time.&nbsp; To
ensure that the OPLAN date and time is GMT time, we have explicitly inserted
Timestamp data values as GMT time in the oplan table in the PostgreSQL
data export.&nbsp; We have come across some versions of PostgreSQL drivers
that did not handle the time zone properly.&nbsp; This is another reason
to use the bbn-postgresql7.1.3.jar in the sys directory.&nbsp;
<br>&nbsp;
<ul>
<li>
If needed, download and install the latest version of PostgreSQL from http://www.postgresql.org</li>

<li>
Download and import the pg_dump-8.6.txt found in the dbms/data/postgresql
directory in the cougaar.zip</li>

<li>
To load the data, use the command:&nbsp; psql dbname &lt; mysqldump.8.6.txt&nbsp;</li>

<li>
Add appropriate command options for host, username and password as needed</li>
</ul>
See the Database Table List identifying all tables in the database exports
and the number or rows in each table.
<br>&nbsp;
<h2>
<a NAME="Running the"></a>Running the Society</h2>
Once you have imported the data into the database and have modified the
cougaar.rc to reflect the appropriate database name, user, password, and
driver, you should be able to successfully run the SMALL-135 society.&nbsp;
See the small-135.readme.html file in the configuration directory for more
information.&nbsp;
<h2>
<a NAME="Database Table"></a>Database Table List</h2>

<h3>
Data Import Results</h3>

<table BORDER WIDTH="100%" >
<tr>
<td ALIGN=CENTER>Table Name</td>

<td ALIGN=CENTER>Number Rows</td>
</tr>

<tr>
<td>aggregated_mei_nomenclature</td>

<td>9509</td>
</tr>

<tr>
<td>alp_mei_dodic_2_view</td>

<td>295</td>
</tr>

<tr>
<td>alp_mei_fuel&nbsp;</td>

<td>100</td>
</tr>

<tr>
<td>alploc&nbsp;</td>

<td>36</td>
</tr>

<tr>
<td>ammo_characteristics&nbsp;</td>

<td>37</td>
</tr>

<tr>
<td>army_packaged_dcr_by_optempo&nbsp;</td>

<td>395</td>
</tr>

<tr>
<td>class1_item&nbsp;</td>

<td>146</td>
</tr>

<tr>
<td>class1_menuitem&nbsp;</td>

<td>7</td>
</tr>

<tr>
<td>class1_supplement_rate&nbsp;</td>

<td>15</td>
</tr>

<tr>
<td>construction_expansion</td>

<td>61</td>
</tr>

<tr>
<td>drop_relationship</td>

<td>2686</td>
</tr>

<tr>
<td>fdm_vehicle&nbsp;</td>

<td>2542</td>
</tr>

<tr>
<td>geoloc&nbsp;</td>

<td>55292</td>
</tr>

<tr>
<td>header&nbsp;</td>

<td>15</td>
</tr>

<tr>
<td>jtav_equipment</td>

<td>8726</td>
</tr>

<tr>
<td>oplan&nbsp;</td>

<td>2</td>
</tr>

<tr>
<td>org_mos&nbsp;</td>

<td>579</td>
</tr>

<tr>
<td>ue_summary_mtmc&nbsp;</td>

<td>44</td>
</tr>
</table>

<dir>&nbsp;</dir>
</td>
</tr>

<tr>
<td></td>
</tr>
</table>

</body>
</html>
