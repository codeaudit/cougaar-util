The Freeze Control Servlet (http://.../$NCA/freezeControl)

The freeze servlet runs as part of the FreezeSocietyPlugin and
provides a user interface for freezing and thawing the society. When
the "Freeze" button is pressed, a relay is created and sent to all
nodes signalling them to freeze all plugins. Plugins in the node
agents receive the relay and pass it on to all the agents of the node.

The freeze servlet displays the frozen status of the society. It shows
"Running" while the society is running normally, "Freezing..." when
the freeze process has just started, "Freezing [list of agents or
nodes not yet frozen]", or "Frozen" when the freeze process has
completed.

The freezing process can take some time because plugins may be in the
middle their execute cycle when it starts. The response indicating
that an agent has frozen is delayed until there are no more threads
still executing any plugins.

The thaw process is nearly instantaneous and only requires the
propagation of the (rescinds of the) relays.

The Freeze Control Plugins

There are three plugins used to implement the freezing of a society
named Freeze{Society,Node,Target}Plugin. These plugins are arranged in
a tree with the society plugin at the root (NCA), the node plugin at
the nodes and the target plugin at the agents. Mainly, these plugins
propagate freeze relays to the agents and gather up the responses of
not-yet-frozen agents to be displayed by the servlet. The servlet is
integral with the society plugin.

Most of the work is done in the target plugins where the arrival of a
freeze relay causes a qualification predicate to be installed in the
agent's ThreadControlService. This predicate selects threads that are
allowed to run. Threads failing the predicate are set aside and not
run. When the "Thaw" button on the servlet is pressed, the freeze
relays are rescinding and the target plugin removes the qualification
predicate from the ThreadControlService. The ThreadControlService
resumes running the plugins previously set aside.

The predicate rejects any thread whose "consumer" is a PluginAdapter
or ComponentPlugin with the exception of the three freeze plugin
classes. The FreezeTargetPlugin can be configured with parameters
naming other classes that should be allowed to run. For example, if
there is a servlet that needs a plugin to work, the name of that
plugin's class could be added as an argument of the
FreezeTargetPlugin.

CSMART Freeze Insertion Recipe

The FreezeInsertion-recipe.sql recipe can be installed in the database
to facilitate the addition of the freeze capability to a society. This
recipe is a Component Collection recipe that installs the three
plugins in their respective agents. Add parameters to the
FreezeTargetPlugin section of the recipe to allow other plugin classes
to continue running while frozen.
